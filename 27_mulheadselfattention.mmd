flowchart TD
    subgraph 输入
        A["输入序列X"]
    end
    subgraph 多头计算
        A --> B["线性变换得到每个头的Q、K、V"]
        B --> C["头1计算自注意力"]
        B --> D["头2计算自注意力"]
        B --> E["..."]
        B --> F["头h计算自注意力"]
    end
    subgraph 拼接与线性变换
        C --> G["头1输出z1"]
        D --> H["头2输出z2"]
        E --> I["..."]
        F --> J["头h输出zh"]
        G --> K["拼接所有头的输出"]
        H --> K
        I --> K
        J --> K
        K --> L["线性变换得到最终输出Z"]
    end